<div class="p-6 space-y-8">
  <h1 class="text-3xl font-bold">Employee Information Dashboard</h1>

  <!-- Summary Cards -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <div class="bg-white p-4 rounded shadow">
      <h2 class="font-medium">Total Employees</h2>
      <p class="text-2xl">{{ totalEmployees }}</p>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <h2 class="font-medium">Average Salary</h2>
      <p class="text-2xl">${{ overallAvgSalary | number:'1.0-2' }}</p>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <h2 class="font-medium">Departments</h2>
      <p class="text-2xl">{{ departmentCount }}</p>
    </div>
  </div>

  <!-- Charts -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    <div class="bg-white p-4 rounded shadow">
      <h3 class="font-medium mb-2">Employees by Department</h3>
      <canvas baseChart [data]="pieChartData" [type]="pieChartType"></canvas>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <h3 class="font-medium mb-2">Avg Salary by Department</h3>
      <canvas baseChart [data]="barChartData" [type]="barChartType"></canvas>
    </div>
  </div>

  <!-- Filters & Export -->
  <div class="flex flex-wrap gap-4 items-center">
    <!-- Template reference for input -->
    <input
      #searchInput
      type="text"
      placeholder="Search name or ID"
      (input)="onSearchTermChange(searchInput.value)"
      class="p-2 border rounded flex-1"
    />

    <!-- Template reference for select -->
    <select
      #deptSelect
      (change)="onDeptChange(deptSelect.value)"
      class="p-2 border rounded"
    >
      <option value="">All Departments</option>
      <option *ngFor="let d of pieChartData.labels" [value]="d">{{ d }}</option>
    </select>

    <button
      (click)="exportCsv()"
      class="ml-auto bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
    >
      Export CSV
    </button>
  </div>

  <!-- Top 5 Earners -->
  <div class="bg-white p-4 rounded shadow">
    <h3 class="font-medium mb-4">Top 5 Earners</h3>

    <p *ngIf="!topEarners.length" class="text-gray-500">
      No top earners to display.
    </p>

    <table *ngIf="topEarners.length" class="w-full table-auto">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-4 py-2">Name</th>
          <th class="px-4 py-2">Salary</th>
          <th class="px-4 py-2">Department</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let u of topEarners" class="odd:bg-white even:bg-gray-50">
          <td class="px-4 py-2">{{ u.name }}</td>
          <td class="px-4 py-2">${{ u.salary | number:'1.0-2' }}</td>
          <td class="px-4 py-2">{{ u.department }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- All Employees Table -->
  <div class="bg-white p-4 rounded shadow">
    <h3 class="font-medium mb-4">All Employees</h3>
    <table class="min-w-full table-auto">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-2 py-1">ID</th>
          <th class="px-4 py-1">Name</th>
          <th class="px-2 py-1">Dept</th>
          <th class="px-4 py-1">Salary</th>
          <th class="px-4 py-1">Phone</th>
          <th class="px-4 py-1">Pincode</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let u of pagedEmployees" class="odd:bg-white even:bg-gray-50 text-sm">
          <td class="px-2 py-1">{{ u.id }}</td>
          <td class="px-4 py-1">{{ u.name }}</td>
          <td class="px-2 py-1">{{ u.department }}</td>
          <td class="px-4 py-1">${{ u.salary | number:'1.0-2' }}</td>
          <td class="px-4 py-1">{{ u.phone }}</td>
          <td class="px-4 py-1">{{ u.pincode }}</td>
        </tr>
      </tbody>
    </table>

    <!-- Pagination Controls -->
    <div class="flex justify-center items-center gap-2 mt-4">
      <button
        (click)="currentPage = currentPage - 1"
        [disabled]="currentPage === 1"
        class="px-3 py-1 bg-gray-200 rounded disabled:opacity-50"
      >Prev</button>
      <span>Page {{ currentPage }} / {{ totalPages }}</span>
      <button
        (click)="currentPage = currentPage + 1"
        [disabled]="currentPage * pageSize >= filteredEmployees.length"
        class="px-3 py-1 bg-gray-200 rounded disabled:opacity-50"
      >Next</button>
    </div>
  </div>
</div>
